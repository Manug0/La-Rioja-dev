pipeline {
    agent any
    environment {
        SFDX_AUTH_URL = credentials('SFDX_AUTH_URL_HSU')
        SFDX_ALIAS = 'hsu'
        PACKAGE_DIR = 'force-app'
        SF_DISABLE_TELEMETRY = "true"
    }
    stages {
        stage('Checkout') { steps { checkout scm } }
        stage('Verificar SFDX') { steps { bat 'sf --version' } }
        stage('Authenticate') {
            steps {
                bat 'echo %SFDX_AUTH_URL% > auth_url.txt'
                bat 'sf org login sfdx-url --sfdx-url-file auth_url.txt --alias %SFDX_ALIAS%'
            }
        }
        stage('Validar código') {
            steps {
                bat 'sf project deploy validate --source-dir %PACKAGE_DIR% --target-org %SFDX_ALIAS% --test-level RunLocalTests'
            }
        }
    }
    post {
        success { echo "Validación completada con éxito." }
        failure { echo "Errores en la validación. Revisa el log de Jenkins." }
    }
}
// This Jenkinsfile is designed to validate code in a Salesforce 